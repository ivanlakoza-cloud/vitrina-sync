{
    email lakoza@ya.ru
}

vitran.ru, www.vitran.ru {
    encode zstd gzip

    # основной прокси на Next.js контейнер
    reverse_proxy web:3000

    # HTTP/3 включится сам, если в SG открыт UDP:443

    # кэшируем только "хэшованную" статику Next
    @nextStatic path /_next/static/* /favicon.ico /robots.txt /sitemap.xml
    header @nextStatic Cache-Control "public, max-age=31536000, immutable"

    # healthcheck
    @health path /healthz
    respond @health 200

    # строгий HTTPS
    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    }
}
